<li><strong>图片多选功能：</strong>每个"项目图片 X"都支持多选，选中的图片会组成一个图片组显示</li>
<li><strong>图片名称编辑：</strong>选择图片后，可以在下方的文本框中编辑每张图片的显示名称</li>
<li><strong>水印设置：</strong>可以调整水印大小模式、位置、透明度等</li>
<li><strong>生成导出：</strong>点击"生成预览"查看效果，满意后点击"导出为图片"（自动压缩至10MB以内）</li>


<!-- 文件选择控制区域 -->
<div class="file-controls">
<!-- 一、项目文案内容 -->
<div class="manual-input-section">
<h4>📝 一、项目文案内容</h4>
<div class="file-input-group">
<label for="manualTitle">1、项目标题（支持换行）：</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualTitle" placeholder="请输入项目标题，可换行显示" rows="2"></textarea>
</div>
<div class="font-size-control">
<label>字体:</label>
<input id="titleFontSize" max="120" min="20" type="number" value="82"/>
<span>px</span>
</div>
</div>
</div>
<div class="file-input-group">
<label for="manualSubtitle">2、项目副标题（支持换行）：</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualSubtitle" placeholder="请输入项目副标题（支持多行）" rows="3"></textarea>
</div>
<div class="font-size-control">
<label>字体:</label>
<input id="subtitleFontSize" max="80" min="14" type="number" value="53"/>
<span>px</span>
</div>
</div>
</div>
<div class="file-input-group">
<label for="manualIntro">3、企业介绍（每段自动首行缩进）：</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualIntro" placeholder="请输入企业介绍内容，支持多段落，每段会自动首行缩进" rows="5"></textarea>
</div>
<div class="font-size-control">
<label>字体:</label>
<input id="introFontSize" max="70" min="12" type="number" value="51"/>
<span>px</span>
</div>
</div>
</div>
<!-- 4、或者选择txt文件 -->
<div class="txt-file-section">
<h4>4、或者选择txt文件自动填充上面的内容</h4>
<div style="display: flex; align-items: center; gap: 10px;">
<input accept=".txt" id="textFile" style="flex: 1;" type="file"/>
<button class="auto-fill-btn" onclick="autoFillFromTxt()">自动填充</button>
</div>
</div>
</div>
<!-- 二、选择Logo图片 -->
<div class="font-size-controls">
<h4>📷 二、选择Logo图片（智能调整尺寸）</h4>
<div class="file-input-group">
<input accept="image/*" id="logoFiles" multiple="" type="file"/>
</div>
</div>
<!-- 三、项目图片设置 -->
<div class="font-size-controls">
<h4>🖼️ 三、项目图片设置</h4>
<div class="font-size-item">
<label>图片板块数量：</label>
<input id="imageBlockCount" max="10" min="1" type="number" value="1"/>
<span>个（设置需要显示几个图片板块）</span>
</div>
<button class="auto-fill-btn" onclick="generateImageInputs()" style="margin-left: 0;">🔄 更新图片选择框</button>
<!-- 图片说明字体大小设置 -->
<div class="font-size-item" style="margin-top: 15px;">
<label>图片说明字体：</label>
<input id="captionFontSize" max="60" min="12" type="number" value="51"/>
<span>px</span>
</div>
</div>
<!-- 动态生成的图片选择区域 -->
<div id="dynamicImageInputs">
<!-- 这里会动态生成图片选择框 -->
</div>
<!-- 四、水印控制区域 -->
<div class="watermark-controls">
<h4>🏷️ 四、水印设置</h4>
<div class="file-input-group">
<label for="watermarkFile">选择水印图片：</label>
<input accept="image/*" id="watermarkFile" type="file"/>
</div>
<div class="watermark-control-row">
<div class="control-group">
<label for="watermarkMode">大小模式：</label>
<select id="watermarkMode">
<option value="fit">适合填充</option>
<option value="fill">拉伸填充</option>
<option value="small">小尺寸</option>
<option value="medium">中等尺寸</option>
<option value="large">大尺寸</option>
</select>
</div>
<div class="control-group">
<label for="watermarkPosition">位置：</label>
<select id="watermarkPosition">
<option value="center">居中</option>
<option value="top-left">左上角</option>
<option value="top-right">右上角</option>
<option value="bottom-left">左下角</option>
<option value="bottom-right">右下角</option>
</select>
</div>
<div class="control-group">
<label for="watermarkOpacity">透明度：</label>
<input id="watermarkOpacity" max="100" min="0" type="range" value="30"/>
<span class="opacity-display" id="opacityDisplay">30%</span>
</div>
</div>
</div>
<div class="button-group">
<button class="refresh-btn" onclick="loadContent()">🔄 生成预览</button>
<div class="export-options">
<label for="exportQuality">导出质量：</label>
<select id="exportQuality">
<option value="3">低质量（3MB以内）</option>
<option selected="" value="5">中质量（5MB以内）</option>
<option value="10">高质量（10MB以内）</option>
<option value="20">超高质量（20MB以内）</option>
<option value="custom">自定义大小</option>
</select>
<input id="customSize" max="50" min="1" placeholder="MB" style="width: 80px; margin-left: 10px; display: none;" type="number" value="8"/>
<span id="customLabel" style="display: none; margin-left: 5px;">MB</span>
</div>
<button class="export-btn" disabled="" id="exportBtn" onclick="exportAsImage()">💾 导出为图片</button>
</div>
<div class="export-status" id="exportStatus" style="display: none;"></div>
</div>
<!-- 主要内容区域 -->
<div id="main-content">
<div class="loading">请填写文案内容，选择图片文件，然后点击"生成预览"按钮</div>
</div>

<!-- 引入html2canvas库 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
        // 全局变量
        let projectData = {
            title: '',
            subtitle: '',
            companyIntro: '',
            logos: [],
            projectImages: [],
            watermark: null,
            watermarkOpacity: 30,
            watermarkMode: 'fit',
            watermarkPosition: 'center',
            imageBlockCount: 1,
            fontSizes: {
                title: 82,
                subtitle: 53,
                intro: 51,
                caption: 51
            },
            imageNames: [],
            imageFiles: []
        };

        // 图片压缩函数
        function compressImage(canvas, maxSize = 10 * 1024 * 1024) {
            let quality = 0.9;
            let compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
            
            function getDataUrlSize(dataUrl) {
                return Math.round((dataUrl.length - 22) * 3 / 4);
            }
            
            while (getDataUrlSize(compressedDataUrl) > maxSize && quality > 0.1) {
                quality -= 0.1;
                compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
            }
            
            if (getDataUrlSize(compressedDataUrl) > maxSize) {
                const scale = Math.sqrt(maxSize / getDataUrlSize(compressedDataUrl));
                const newWidth = Math.floor(canvas.width * scale);
                const newHeight = Math.floor(canvas.height * scale);
                
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = newWidth;
                tempCanvas.height = newHeight;
                
                tempCtx.drawImage(canvas, 0, 0, newWidth, newHeight);
                compressedDataUrl = tempCanvas.toDataURL('image/jpeg', 0.9);
            }
            
            return compressedDataUrl;
        }

        // 智能调整Logo尺寸
        function adjustLogoSize(img) {
            const aspectRatio = img.naturalWidth / img.naturalHeight;
            
            if (aspectRatio > 1.2) {
                img.style.width = '800px';
                img.style.height = 'auto';
            } else if (aspectRatio < 0.8) {
                img.style.height = '800px';
                img.style.width = 'auto';
            } else {
                img.style.maxWidth = '800px';
                img.style.maxHeight = '800px';
            }
        }

        // 读取文本文件内容
        function readTextFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    resolve(e.target.result);
                };
                reader.onerror = reject;
                reader.readAsText(file, 'UTF-8');
            });
        }

        // 读取图片文件
        function readImageFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const nameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
                    resolve({
                        name: nameWithoutExtension,
                        src: e.target.result
                    });
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // 解析文案文件
        function parseTextContent(content) {
            const lines = content.split('\n');
            const data = {};
            
            let currentSection = null;
            let subtitleParts = [];
            let introParts = [];
            
            lines.forEach(line => {
                const trimmedLine = line.trim();
                
                if (trimmedLine.includes('【项目标题】:') || trimmedLine.includes('【项目标题】：')) {
                    const colonIndex = trimmedLine.search(/[：:]/);
                    data.title = trimmedLine.substring(colonIndex + 1).trim();
                    currentSection = 'title';
                } 
                else if (trimmedLine.includes('【项目副标题】:') || trimmedLine.includes('【项目副标题】：')) {
                    const colonIndex = trimmedLine.search(/[：:]/);
                    const subtitleContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (subtitleContent) {
                        subtitleParts.push(subtitleContent);
                    }
                    currentSection = 'subtitle';
                } 
                else if (trimmedLine.includes('【介绍内容】:') || trimmedLine.includes('【介绍内容】：')) {
                    const colonIndex = trimmedLine.search(/[：:]/);
                    const introContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (introContent) {
                        introParts.push(introContent);
                    }
                    currentSection = 'intro';
                }
                else if (trimmedLine.includes('标题:') || trimmedLine.includes('主标题:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    data.title = trimmedLine.substring(colonIndex + 1).trim();
                    currentSection = 'title';
                } 
                else if (trimmedLine.includes('副标题:') || trimmedLine.includes('子标题:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    const subtitleContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (subtitleContent) {
                        subtitleParts.push(subtitleContent);
                    }
                    currentSection = 'subtitle';
                } 
                else if (trimmedLine.includes('企业介绍:') || trimmedLine.includes('公司介绍:') || trimmedLine.includes('介绍:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    const introContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (introContent) {
                        introParts.push(introContent);
                    }
                    currentSection = 'intro';
                }
                else if (currentSection === 'subtitle' && trimmedLine && !trimmedLine.includes('【') && !trimmedLine.includes(':')) {
                    subtitleParts.push(trimmedLine);
                }
                else if (currentSection === 'intro' && !trimmedLine.includes('【') && !trimmedLine.includes(':')) {
                    if (trimmedLine === '' && introParts.length > 0) {
                        introParts.push('\n');
                    } else if (trimmedLine) {
                        introParts.push(trimmedLine);
                    }
                }
            });

            if (subtitleParts.length > 0) {
                data.subtitle = subtitleParts.join('\n');
            }

            if (introParts.length > 0) {
                data.companyIntro = introParts.join('\n');
            }

            if (!data.title && lines.length > 0) {
                data.title = lines[0].trim();
            }
            if (!data.subtitle && lines.length > 1) {
                data.subtitle = lines[1].trim();
            }
            if (!data.companyIntro && lines.length > 2) {
                data.companyIntro = lines.slice(2).join('\n');
            }

            return data;
        }

        // 生成动态图片输入框
        function generateImageInputs() {
            const count = parseInt(document.getElementById('imageBlockCount').value);
            const container = document.getElementById('dynamicImageInputs');
            
            let html = '<h4 style="color: #0056b3; margin: 15px 0 10px 0;">📸 项目图片选择</h4>';
            
            for (let i = 1; i <= count; i++) {
                html += `
                    <div class="file-input-group">
                        <label for="projectImage${i}">项目图片 ${i}：</label>
                        <input type="file" id="projectImage${i}" accept="image/*" multiple onchange="previewImage(${i})">
                        <div id="preview${i}" style="margin-top: 5px; font-size: 12px; color: #666;"></div>
                        <div id="imageNames${i}" class="image-name-edit" style="display: none;">
                            <div class="image-preview-header">📝 编辑图片名称：</div>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
            projectData.imageBlockCount = count;
        }

        // 预览选择的图片并生成名称编辑框
        function previewImage(index) {
            const fileInput = document.getElementById(`projectImage${index}`);
            const preview = document.getElementById(`preview${index}`);
            const imageNamesContainer = document.getElementById(`imageNames${index}`);
            
            if (fileInput.files && fileInput.files.length > 0) {
                let fileNames = [];
                let nameEditHTML = '<div class="image-preview-header">📝 编辑图片名称（可拖拽排序）：</div>';
                
                if (!projectData.imageFiles[index - 1]) {
                    projectData.imageFiles[index - 1] = [];
                }
                projectData.imageFiles[index - 1] = Array.from(fileInput.files);
                
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const nameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
                    fileNames.push(nameWithoutExtension);
                    
                    const previewUrl = URL.createObjectURL(file);
                    
                    nameEditHTML += `
                        <div class="image-name-item" draggable="true" data-index="${i}" 
                             ondragstart="handleDragStart(event, ${index})" 
                             ondragover="handleDragOver(event)" 
                             ondrop="handleDrop(event, ${index})"
                             ondragend="handleDragEnd(event)">
                            <span class="drag-handle">⋮⋮</span>
                            <img src="${previewUrl}" alt="预览" class="image-preview-thumb">
                            <label>图片${i + 1}:</label>
                            <input type="text" id="imageName${index}_${i}" value="${nameWithoutExtension}" 
                                   placeholder="输入图片显示名称" onchange="updateImageName(${index}, ${i})"
                                   style="flex: 1;">
                            <button onclick="removeImage(${index}, ${i})">删除</button>
                        </div>
                    `;
                }
                
                if (fileNames.length === 1) {
                    preview.innerHTML = `✅ 已选择: ${fileNames[0]}`;
                } else {
                    preview.innerHTML = `✅ 已选择 ${fileNames.length} 个文件: ${fileNames.join(', ')}`;
                }
                preview.style.color = '#28a745';
                
                imageNamesContainer.innerHTML = nameEditHTML;
                imageNamesContainer.style.display = 'block';
                
                if (!projectData.imageNames[index - 1]) {
                    projectData.imageNames[index - 1] = [];
                }
                projectData.imageNames[index - 1] = fileNames.slice();
                
            } else {
                preview.innerHTML = '';
                imageNamesContainer.style.display = 'none';
                if (projectData.imageFiles[index - 1]) {
                    projectData.imageFiles[index - 1].forEach(file => {
                        if (file.previewUrl) {
                            URL.revokeObjectURL(file.previewUrl);
                        }
                    });
                }
            }
        }

        // 拖拽排序相关函数
        let draggedElement = null;
        let draggedIndex = null;
        let draggedBlockIndex = null;

        function handleDragStart(event, blockIndex) {
            draggedElement = event.target.closest('.image-name-item');
            draggedIndex = parseInt(draggedElement.getAttribute('data-index'));
            draggedBlockIndex = blockIndex;
            draggedElement.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
        }

        function handleDrop(event, blockIndex) {
            event.preventDefault();
            
            if (blockIndex !== draggedBlockIndex) return;
            
            const targetElement = event.target.closest('.image-name-item');
            if (!targetElement || targetElement === draggedElement) return;
            
            const targetIndex = parseInt(targetElement.getAttribute('data-index'));
            
            const imageFiles = projectData.imageFiles[blockIndex - 1];
            const imageNames = projectData.imageNames[blockIndex - 1];
            
            if (imageFiles && imageNames) {
                const movedFile = imageFiles.splice(draggedIndex, 1)[0];
                const movedName = imageNames.splice(draggedIndex, 1)[0];
                
                imageFiles.splice(targetIndex, 0, movedFile);
                imageNames.splice(targetIndex, 0, movedName);
                
                regenerateImagePreview(blockIndex);
            }
        }

        function handleDragEnd(event) {
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
            }
            draggedElement = null;
            draggedIndex = null;
            draggedBlockIndex = null;
        }

        // 重新生成图片预览
        function regenerateImagePreview(blockIndex) {
            const imageNamesContainer = document.getElementById(`imageNames${blockIndex}`);
            const imageFiles = projectData.imageFiles[blockIndex - 1];
            const imageNames = projectData.imageNames[blockIndex - 1];
            
            if (!imageFiles || !imageNames) return;
            
            let nameEditHTML = '<div class="image-preview-header">📝 编辑图片名称（可拖拽排序）：</div>';
            
            for (let i = 0; i < imageFiles.length; i++) {
                const file = imageFiles[i];
                const name = imageNames[i];
                const previewUrl = URL.createObjectURL(file);
                
                nameEditHTML += `
                    <div class="image-name-item" draggable="true" data-index="${i}" 
                         ondragstart="handleDragStart(event, ${blockIndex})" 
                         ondragover="handleDragOver(event)" 
                         ondrop="handleDrop(event, ${blockIndex})"
                         ondragend="handleDragEnd(event)">
                        <span class="drag-handle">⋮⋮</span>
                        <img src="${previewUrl}" alt="预览" class="image-preview-thumb">
                        <label>图片${i + 1}:</label>
                        <input type="text" id="imageName${blockIndex}_${i}" value="${name}" 
                               placeholder="输入图片显示名称" onchange="updateImageName(${blockIndex}, ${i})"
                               style="flex: 1;">
                        <button onclick="removeImage(${blockIndex}, ${i})">删除</button>
                    </div>
                `;
            }
            
            imageNamesContainer.innerHTML = nameEditHTML;
        }

        // 删除图片
        function removeImage(blockIndex, imageIndex) {
            const files = projectData.imageFiles[blockIndex - 1];
            const names = projectData.imageNames[blockIndex - 1];

            if (files && imageIndex < files.length) {
                files.splice(imageIndex, 1);
                names.splice(imageIndex, 1);
            }

            regenerateImagePreview(blockIndex);
            
            const preview = document.getElementById(`preview${blockIndex}`);
            if (files.length > 0) {
                preview.innerHTML = `✅ 当前共 ${files.length} 张图片`;
            } else {
                preview.innerHTML = '';
                document.getElementById(`imageNames${blockIndex}`).style.display = 'none';
            }
        }

        // 更新图片名称
        function updateImageName(blockIndex, imageIndex) {
            const nameInput = document.getElementById(`imageName${blockIndex}_${imageIndex}`);
            if (nameInput && projectData.imageNames[blockIndex - 1]) {
                projectData.imageNames[blockIndex - 1][imageIndex] = nameInput.value.trim() || `图片${imageIndex + 1}`;
            }
        }

        // 获取手动输入的内容
        function getManualContent() {
            return {
                title: document.getElementById('manualTitle').value.trim(),
                subtitle: document.getElementById('manualSubtitle').value.trim(),
                companyIntro: document.getElementById('manualIntro').value.trim()
            };
        }

        // 从txt文件自动填充内容
        async function autoFillFromTxt() {
            const textFile = document.getElementById('textFile').files[0];
            if (!textFile) {
                return;
            }

            try {
                const textContent = await readTextFile(textFile);
                const parsedData = parseTextContent(textContent);
                
                document.getElementById('manualTitle').value = parsedData.title || '';
                document.getElementById('manualSubtitle').value = parsedData.subtitle || '';
                document.getElementById('manualIntro').value = parsedData.companyIntro || '';
                
                setTimeout(() => {
                    const hint = document.createElement('div');
                    hint.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #4caf50; color: white; padding: 10px 15px; border-radius: 5px; z-index: 1000; font-size: 14px;';
                    hint.textContent = '✅ 文案内容已自动填充完成！';
                    document.body.appendChild(hint);
                    
                    setTimeout(() => {
                        document.body.removeChild(hint);
                    }, 2000);
                }, 100);
                
            } catch (error) {
                console.error('读取txt文件时出错:', error);
                const errorHint = document.createElement('div');
                errorHint.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #f44336; color: white; padding: 10px 15px; border-radius: 5px; z-index: 1000; font-size: 14px;';
                errorHint.textContent = '❌ 读取txt文件时出错，请检查文件格式';
                document.body.appendChild(errorHint);
                
                setTimeout(() => {
                    document.body.removeChild(errorHint);
                }, 3000);
            }
        }

        // 加载内容
        async function loadContent() {
            const logoFiles = document.getElementById('logoFiles').files;
            const watermarkFile = document.getElementById('watermarkFile').files[0];
            
            const mainContent = document.getElementById('main-content');
            const exportBtn = document.getElementById('exportBtn');
            const exportStatus = document.getElementById('exportStatus');
            
            mainContent.innerHTML = '<div class="loading">正在生成预览...</div>';
            exportBtn.disabled = true;
            exportStatus.style.display = 'none';

            try {
                projectData.fontSizes.title = parseInt(document.getElementById('titleFontSize').value);
                projectData.fontSizes.subtitle = parseInt(document.getElementById('subtitleFontSize').value);
                projectData.fontSizes.intro = parseInt(document.getElementById('introFontSize').value);
                projectData.fontSizes.caption = parseInt(document.getElementById('captionFontSize').value);
                projectData.watermarkMode = document.getElementById('watermarkMode').value;
                projectData.watermarkPosition = document.getElementById('watermarkPosition').value;
                projectData.watermarkOpacity = parseInt(document.getElementById('watermarkOpacity').value);
                projectData.imageBlockCount = parseInt(document.getElementById('imageBlockCount').value);

                const manualContent = getManualContent();
                projectData.title = manualContent.title || '请输入项目标题';
                projectData.subtitle = manualContent.subtitle || '请输入项目副标题';
                projectData.companyIntro = manualContent.companyIntro || '请输入企业介绍内容';

                projectData.logos = [];
                if (logoFiles.length > 0) {
                    for (let file of logoFiles) {
                        const imageData = await readImageFile(file);
                        projectData.logos.push(imageData);
                    }
                }

                projectData.projectImages = [];
                const blockCount = projectData.imageBlockCount;
                
                for (let i = 1; i <= blockCount; i++) {
                    if (projectData.imageFiles[i - 1] && projectData.imageFiles[i - 1].length > 0) {
                        const blockImages = [];
                        for (let j = 0; j < projectData.imageFiles[i - 1].length; j++) {
                            const file = projectData.imageFiles[i - 1][j];
                            const imageData = await readImageFile(file);
                            if (projectData.imageNames[i - 1] && projectData.imageNames[i - 1][j]) {
                                imageData.name = projectData.imageNames[i - 1][j];
                            }
                            blockImages.push(imageData);
                        }
                        projectData.projectImages.push(blockImages);
                    } else {
                        const fileInput = document.getElementById(`projectImage${i}`);
                        if (fileInput && fileInput.files && fileInput.files.length > 0) {
                            const blockImages = [];
                            for (let j = 0; j < fileInput.files.length; j++) {
                                const imageData = await readImageFile(fileInput.files[j]);
                                if (projectData.imageNames[i - 1] && projectData.imageNames[i - 1][j]) {
                                    imageData.name = projectData.imageNames[i - 1][j];
                                }
                                blockImages.push(imageData);
                            }
                            projectData.projectImages.push(blockImages);
                        } else {
                            projectData.projectImages.push([]);
                        }
                    }
                }

                if (watermarkFile) {
                    projectData.watermark = await readImageFile(watermarkFile);
                }

                renderContent();
                exportBtn.disabled = false;
                
            } catch (error) {
                console.error('生成预览时出错:', error);
                mainContent.innerHTML = '<div class="error">生成预览时出错，请检查文件格式和内容。</div>';
                exportBtn.disabled = true;
            }
        }

        // 渲染内容
        function renderContent() {
            const mainContent = document.getElementById('main-content');
            
            let html = `
                <div class="header">
                    <h1 class="main-title" style="font-size: ${projectData.fontSizes.title}px;">${projectData.title}</h1>
                    <p class="subtitle" style="font-size: ${projectData.fontSizes.subtitle}px;">${projectData.subtitle}</p>
                </div>

                <div class="logo-section">
                    ${projectData.logos.map(logo => `
                        <div class="logo-container">
                            <img src="${logo.src}" alt="${logo.name}" onload="adjustLogoSize(this)">
                        </div>
                    `).join('')}
                </div>

                <div class="company-intro">
                    ${formatCompanyIntro(projectData.companyIntro, projectData.fontSizes.intro)}
                </div>

                <div class="project-showcase">
                    ${generateImageBlocks()}
                </div>
            `;

            mainContent.innerHTML = html;

            if (projectData.watermark) {
                setTimeout(() => {
                    drawWatermarks();
                }, 100);
            }
        }

        // 格式化企业介绍，支持分段和首行缩进
        function formatCompanyIntro(content, fontSize) {
            const paragraphs = content.split('\n').filter(p => p.trim());
            return paragraphs.map(paragraph => 
                `<p style="font-size: ${fontSize}px;">${paragraph}</p>`
            ).join('');
        }

        // 生成图片板块
        function generateImageBlocks() {
            let blocks = '';
            const blockCount = projectData.imageBlockCount;
            
            for (let i = 0; i < blockCount; i++) {
                const blockImages = projectData.projectImages[i];
                
                // 移除分割线生成代码
                blocks += '<div class="project-section">';
                
                if (blockImages && blockImages.length > 0) {
                    blockImages.forEach((image, imageIndex) => {
                        blocks += `
                            <div class="image-container">
                                <div class="image-with-watermark">
                                    <img src="${image.src}" alt="项目图片${i + 1}-${imageIndex + 1}" class="project-image">
                                    ${projectData.watermark ? `
                                        <canvas class="watermark-overlay" data-image-index="${i}-${imageIndex}"></canvas>
                                    ` : ''}
                                </div>
                                <div class="image-caption" style="font-size: ${projectData.fontSizes.caption}px;">${image.name}</div>
                            </div>
                        `;
                    });
                } else {
                    blocks += `
                        <div class="image-placeholder">
                            <div class="placeholder-content">
                                <div style="text-align: center;">
                                    <div class="placeholder-icon">🖼️</div>
                                    <div class="placeholder-text">
                                        <div>图片组 ${i + 1}</div>
                                        <div class="placeholder-subtitle">等待选择图片（可多选）</div>
                                    </div>
                                </div>
                            </div>
                            <div class="image-caption" style="font-size: ${projectData.fontSizes.caption}px;">图片组 ${i + 1}</div>
                        </div>
                    `;
                }
                
                blocks += '</div>';
            }
            
            return blocks;
        }

        // 计算水印尺寸和位置
        function calculateWatermarkDimensions(canvasWidth, canvasHeight, watermarkImg, mode) {
            let width, height, x, y;
            
            switch (mode) {
                case 'fit':
                    const scale = Math.max(canvasWidth / watermarkImg.width, canvasHeight / watermarkImg.height);
                    width = watermarkImg.width * scale;
                    height = watermarkImg.height * scale;
                    break;
                case 'fill':
                    width = canvasWidth;
                    height = canvasHeight;
                    break;
                case 'small':
                    width = canvasWidth * 0.2;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                case 'medium':
                    width = canvasWidth * 0.4;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                case 'large':
                    width = canvasWidth * 0.6;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                default:
                    width = canvasWidth * 0.3;
                    height = (watermarkImg.height / watermarkImg.width) * width;
            }
            
            switch (projectData.watermarkPosition) {
                case 'top-left':
                    x = 20;
                    y = 20;
                    break;
                case 'top-right':
                    x = canvasWidth - width - 20;
                    y = 20;
                    break;
                case 'bottom-left':
                    x = 20;
                    y = canvasHeight - height - 20;
                    break;
                case 'bottom-right':
                    x = canvasWidth - width - 20;
                    y = canvasHeight - height - 20;
                    break;
                case 'center':
                default:
                    x = (canvasWidth - width) / 2;
                    y = (canvasHeight - height) / 2;
                    break;
            }
            
            return { width, height, x, y };
        }

        // 绘制水印
        function drawWatermarks() {
            const watermarkCanvases = document.querySelectorAll('.watermark-overlay');
            
            watermarkCanvases.forEach((canvas) => {
                const projectImage = canvas.previousElementSibling;
                
                if (projectImage.complete) {
                    drawWatermarkOnCanvas(canvas, projectImage, projectData.watermark);
                } else {
                    projectImage.onload = () => {
                        drawWatermarkOnCanvas(canvas, projectImage, projectData.watermark);
                    };
                }
            });
        }

        // 在画布上绘制水印
        function drawWatermarkOnCanvas(canvas, projectImage, watermark) {
            const ctx = canvas.getContext('2d');
            
            canvas.width = projectImage.offsetWidth;
            canvas.height = projectImage.offsetHeight;
            
            const watermarkImg = new Image();
            watermarkImg.onload = () => {
                const dimensions = calculateWatermarkDimensions(
                    canvas.width, 
                    canvas.height, 
                    watermarkImg, 
                    projectData.watermarkMode
                );
                
                ctx.globalAlpha = projectData.watermarkOpacity / 100;
                ctx.drawImage(watermarkImg, dimensions.x, dimensions.y, dimensions.width, dimensions.height);
            };
            
            watermarkImg.src = watermark.src;
        }

        // 导出为图片（固定1080px宽度，不受设备影响）
        async function exportAsImage() {
            const exportBtn = document.getElementById('exportBtn');
            const exportStatus = document.getElementById('exportStatus');
            const mainContent = document.getElementById('main-content');
            
            // 获取用户选择的压缩大小
            const qualitySelect = document.getElementById('exportQuality');
            const customSizeInput = document.getElementById('customSize');
            let maxSizeMB;
            
            if (qualitySelect.value === 'custom') {
                maxSizeMB = parseInt(customSizeInput.value) || 8;
            } else {
                maxSizeMB = parseInt(qualitySelect.value);
            }
            
            const maxSize = maxSizeMB * 1024 * 1024; // 转换为字节
            
            exportBtn.disabled = true;
            exportStatus.style.display = 'block';
            exportStatus.className = 'export-status loading';
            exportStatus.textContent = `正在生成图片（目标大小：${maxSizeMB}MB以内）...`;

            try {
                // 临时设置容器为固定1080px宽度进行截图
                const originalWidth = mainContent.style.width;
                const originalMaxWidth = mainContent.style.maxWidth;
                const originalTransform = mainContent.style.transform;
                const originalOverflow = document.body.style.overflow;
                
                // 强制设置为1080px宽度
                mainContent.style.width = '1080px';
                mainContent.style.maxWidth = '1080px';
                mainContent.style.transform = 'scale(1)';
                document.body.style.overflow = 'visible';
                
                // 等待一下让DOM更新
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // 计算实际高度
                const actualHeight = mainContent.scrollHeight;
                
                const options = {
                    scale: 1,
                    useCORS: true,
                    allowTaint: false,
                    backgroundColor: '#ffffff',
                    width: 1080,
                    height: actualHeight,
                    scrollX: 0,
                    scrollY: 0,
                    x: 0,
                    y: 0
                };

                const canvas = await html2canvas(mainContent, options);
                
                // 恢复原始样式
                mainContent.style.width = originalWidth;
                mainContent.style.maxWidth = originalMaxWidth;
                mainContent.style.transform = originalTransform;
                document.body.style.overflow = originalOverflow;
                
                // 确保canvas是1080px宽度
                let finalCanvas = canvas;
                if (canvas.width !== 1080) {
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCanvas.width = 1080;
                    tempCanvas.height = Math.round((canvas.height / canvas.width) * 1080);
                    
                    // 将原canvas内容按比例绘制到1080px宽度的canvas上
                    tempCtx.drawImage(canvas, 0, 0, 1080, tempCanvas.height);
                    finalCanvas = tempCanvas;
                }
                
                const compressedDataUrl = compressImage(finalCanvas, maxSize);
                
                // 获取项目标题作为文件名
                const projectTitle = projectData.title || '项目展示';
                const cleanTitle = projectTitle.replace(/[<>:"/\\|?*\n\r]/g, '').trim();
                const qualityLabel = qualitySelect.options[qualitySelect.selectedIndex].text.split('（')[0];
                
                const link = document.createElement('a');
                link.download = `${cleanTitle}_${qualityLabel}.jpg`;
                link.href = compressedDataUrl;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                const fileSizeKB = Math.round((compressedDataUrl.length - 22) * 3 / 4 / 1024);
                const fileSizeMB = (fileSizeKB / 1024).toFixed(2);
                
                exportStatus.className = 'export-status success';
                exportStatus.textContent = `图片导出成功！尺寸: ${finalCanvas.width}x${finalCanvas.height}px，文件大小: ${fileSizeMB}MB`;
                
                setTimeout(() => {
                    exportStatus.style.display = 'none';
                }, 5000);
                
            } catch (error) {
                console.error('导出图片时出错:', error);
                exportStatus.className = 'export-status error';
                exportStatus.textContent = '导出失败，请重试。';
                
                // 确保恢复样式
                mainContent.style.width = '';
                mainContent.style.maxWidth = '';
                mainContent.style.transform = '';
                document.body.style.overflow = '';
            } finally {
                exportBtn.disabled = false;
            }
        }

        // 处理导出质量选择变化
        function handleExportQualityChange() {
            const qualitySelect = document.getElementById('exportQuality');
            const customSizeInput = document.getElementById('customSize');
            const customLabel = document.getElementById('customLabel');
            
            if (qualitySelect.value === 'custom') {
                customSizeInput.style.display = 'inline-block';
                customLabel.style.display = 'inline';
            } else {
                customSizeInput.style.display = 'none';
                customLabel.style.display = 'none';
            }
        }

        // 初始化事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            generateImageInputs();
            
            // 导出质量选择监听器
            document.getElementById('exportQuality').addEventListener('change', handleExportQualityChange);
            
            document.getElementById('watermarkOpacity').addEventListener('input', function() {
                const value = this.value;
                document.getElementById('opacityDisplay').textContent = value + '%';
                projectData.watermarkOpacity = parseInt(value);
            });

            document.getElementById('watermarkMode').addEventListener('change', function() {
                projectData.watermarkMode = this.value;
            });

            document.getElementById('watermarkPosition').addEventListener('change', function() {
                projectData.watermarkPosition = this.value;
            });

            ['titleFontSize', 'subtitleFontSize', 'introFontSize', 'captionFontSize', 'imageBlockCount'].forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    if (id === 'imageBlockCount') {
                        projectData.imageBlockCount = parseInt(this.value);
                    } else {
                        const key = id.replace('FontSize', '');
                        projectData.fontSizes[key] = parseInt(this.value);
                    }
                });
            });
        });
    </script>

<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>项目展示模板</title>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');

        body {
            font-family: 'Noto Sans SC', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1080px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
        }

        /* 标题区域 */
        .header {
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 52px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            letter-spacing: 1px;
            line-height: 1.2;
            white-space: pre-line; /* 支持换行 */
        }

        .subtitle {
            font-size: 23px;
            color: #666;
            line-height: 1.6;
            font-weight: 400;
            text-align: left;
            max-width: 1600px;
            margin: 0 auto;
            white-space: pre-line; /* 支持换行 */
        }

        /* Logo区域 */
        .logo-section {
            text-align: center;
            margin: 40px 0;
            padding: 30px 0;
            /* 移除灰色背景 */
        }

        .logo-container {
            display: inline-block;
            margin: 20px;
        }

        .logo-container img {
            max-width: 800px;
            max-height: 800px;
            height: auto;
            width: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* 企业介绍 */
        .company-intro {
            margin: 50px 0;
            padding: 40px;
            background-color: #f8f9fa;
            border-radius: 12px;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            border-left: 5px solid #007bff;
        }

        .company-intro p {
            font-size: 21px;
            line-height: 1.8;
            color: #555;
            font-weight: 400;
            max-width: 1540px;
            margin: 0 auto 20px auto;
            text-align: left;
            text-indent: 2em; /* 首行缩进 */
            white-space: pre-line; /* 支持换行和段落 */
        }

        .company-intro p:last-child {
            margin-bottom: 0;
        }

        /* 项目展示区域 */
        .project-showcase {
            margin-top: 60px;
        }

        .project-section {
            margin-bottom: 80px; /* 板块间隔 */
            padding: 20px 0;
        }

        .project-section:last-child {
            margin-bottom: 20px;
        }

        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, #e0e0e0, transparent);
            margin: 40px 0;
        }

        .image-container {
            margin: 40px 0;
            text-align: center;
            position: relative;
        }

        .project-image {
            width: 100%;
            max-width: 1600px;
            height: auto;
            border-radius: 12px 12px 0 0; /* 只有上方有圆角 */
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            margin-bottom: 0; /* 完全贴合 */
            position: relative;
            transition: transform 0.3s ease;
            display: block;
        }

        .project-image:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
        }

        .image-with-watermark {
            position: relative;
            display: inline-block;
            margin-bottom: 0; /* 完全贴合 */
        }

        .watermark-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            border-radius: 12px 12px 0 0; /* 只有上方有圆角 */
        }

        .image-caption {
            font-size: 21px;
            color: #666;
            margin-top: 0; /* 完全贴合 */
            font-weight: 500;
            text-align: center;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            padding: 12px 20px;
            background-color: rgba(255,255,255,0.95);
            border-radius: 0 0 12px 12px; /* 只有下方有圆角 */
            border: 1px solid #e9ecef;
            border-top: none; /* 移除顶部边框，与图片完全贴合 */
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); /* 添加轻微阴影 */
        }

        /* 图片占位符样式优化 */
        .image-placeholder {
            margin: 40px 0;
        }

        .placeholder-content {
            width: 100%; 
            max-width: 1600px; 
            height: 400px; 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #ddd; 
            border-radius: 12px 12px 0 0; /* 与实际图片保持一致 */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #999;
            font-size: 18px;
            margin-bottom: 0; /* 与实际图片保持一致 */
            transition: all 0.3s ease;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15), 0 6px 20px rgba(0,0,0,0.1); /* 增强阴影 */
        }

        .placeholder-content:hover {
            border-color: #007bff;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            box-shadow: 0 16px 48px rgba(0,0,0,0.2), 0 8px 24px rgba(0,0,0,0.15); /* hover时更强阴影 */
        }

        .placeholder-icon {
            font-size: 64px; 
            margin-bottom: 15px;
            opacity: 0.6;
        }

        .placeholder-text {
            text-align: center;
        }

        .placeholder-subtitle {
            font-size: 14px; 
            margin-top: 8px;
            opacity: 0.7;
        }

        /* 加载状态 */
        .loading {
            text-align: center;
            padding: 60px 40px;
            color: #666;
            background-color: #f8f9fa;
            border-radius: 12px;
            font-size: 18px;
        }

        .error {
            color: #e74c3c;
            text-align: center;
            padding: 30px;
            background-color: #fdf2f2;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid #e74c3c;
        }

        /* 文件上传区域 */
        .file-controls {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 2px dashed #ddd;
        }

        .file-input-group {
            margin: 20px 0;
        }

        .file-input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #555;
            font-size: 15px;
        }

        .file-input-group input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: white;
            font-size: 14px;
            font-family: inherit;
        }

        .file-input-group input[type="file"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        .file-input-group input[type="text"], 
        .file-input-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: white;
            font-size: 14px;
            font-family: inherit;
        }

        .file-input-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* 输入框和字体设置的对应布局 */
        .input-with-font-size {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-with-font-size .main-input {
            flex: 1;
        }

        .input-with-font-size .font-size-control {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #f0f8ff;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #cce7ff;
            white-space: nowrap;
        }

        .input-with-font-size .font-size-control label {
            margin: 0;
            font-size: 12px;
            color: #0056b3;
            font-weight: 500;
        }

        .input-with-font-size .font-size-control input[type="number"] {
            width: 60px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
        }

        .input-with-font-size .font-size-control span {
            font-size: 12px;
            color: #666;
        }

        .watermark-controls {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }

        .watermark-controls h4 {
            color: #0056b3;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .inline-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .inline-controls .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .inline-controls label {
            margin-bottom: 0 !important;
            white-space: nowrap;
            font-weight: 500;
        }

        .inline-controls input[type="file"] {
            width: auto;
            min-width: 220px;
        }

        .inline-controls input[type="range"] {
            width: 150px;
        }

        .inline-controls input[type="number"] {
            width: 80px;
            padding: 6px;
        }

        .inline-controls select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: white;
        }

        .opacity-display {
            font-size: 14px;
            color: #666;
            min-width: 35px;
            text-align: center;
            font-weight: 500;
        }

        .watermark-control-row {
            display: flex;
            gap: 25px;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .export-options {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .export-options label {
            font-weight: 500;
            color: #495057;
            font-size: 14px;
            margin: 0;
        }

        .export-options select {
            padding: 6px 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            background-color: white;
            font-size: 13px;
            min-width: 140px;
        }

        .export-options input[type="number"] {
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
        }

        .refresh-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,123,255,0.2);
        }

        .refresh-btn:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }

        .export-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(40,167,69,0.2);
        }

        .export-btn:hover {
            background-color: #218838;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(40,167,69,0.3);
        }

        .export-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .instructions {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #2196f3;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .instructions ul {
            margin-left: 25px;
        }

        .instructions li {
            margin: 8px 0;
            color: #555;
            line-height: 1.5;
        }

        /* 导出状态提示 */
        .export-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
        }

        .export-status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .export-status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .export-status.loading {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* 手动输入区域 */
        .manual-input-section {
            background-color: #fff3cd;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }

        .manual-input-section h4 {
            color: #856404;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .font-size-controls {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }

        .font-size-controls h4 {
            color: #0056b3;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .font-size-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
        }

        .font-size-item label {
            min-width: 90px;
            font-size: 14px;
            color: #555;
            font-weight: 500;
        }

        .font-size-item input[type="number"] {
            width: 80px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .font-size-item span {
            font-size: 12px;
            color: #666;
        }

        .txt-file-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #6c757d;
        }

        .txt-file-section h4 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .auto-fill-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }

        .auto-fill-btn:hover {
            background-color: #545b62;
        }

        /* 图片名称编辑区域 */
        .image-name-edit {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #e9ecef;
        }

        .image-name-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 0;
            padding: 8px;
            background-color: white;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }

        .image-name-item label {
            min-width: 60px;
            font-size: 12px;
            color: #666;
            margin: 0;
        }

        .image-name-item input[type="text"] {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
        }

        .image-preview-header {
            font-size: 13px;
            color: #495057;
            font-weight: 500;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .image-name-font-control {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #e3f2fd;
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid #bbdefb;
        }

        .image-name-font-control label {
            margin: 0;
            font-size: 11px;
            color: #1976d2;
            font-weight: 500;
        }

        .image-name-font-control input[type="number"] {
            width: 50px;
            padding: 3px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 11px;
            text-align: center;
        }

        .image-name-font-control span {
            font-size: 11px;
            color: #666;
        }
    
        .image-preview-thumb {
            max-width: 120px;
            max-height: 120px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        .image-name-item button {
            padding: 4px 8px; 
            margin-left: 8px; 
            background: #e74c3c; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer;
            font-size: 11px;
            transition: background-color 0.3s;
        }

        .image-name-item button:hover {
            background: #c0392b;
        }

        /* 拖拽样式 */
        .dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .drag-handle {
            cursor: grab;
            color: #999;
            font-size: 16px;
            padding: 2px;
        }

        /* 移动端优化 */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .file-input-group input[type="file"],
            .file-input-group input[type="text"], 
            .file-input-group textarea,
            .file-input-group input[type="number"] {
                padding: 15px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .refresh-btn, .export-btn {
                padding: 16px 24px;
                font-size: 16px;
                min-height: 48px;
                width: 100%;
                margin: 5px 0;
            }
            
            .button-group {
                flex-direction: column;
                width: 100%;
            }
            
            .export-options {
                width: 100%;
                justify-content: center;
                padding: 15px;
            }
            
            .export-options select {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
                flex: 1;
            }
            
            .export-options input[type="number"] {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
                width: 100px;
            }
            
            .auto-fill-btn {
                padding: 12px 20px;
                font-size: 16px;
                min-height: 44px;
                width: 100%;
                margin: 10px 0;
            }
            
            .watermark-control-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .control-group {
                width: 100%;
                justify-content: space-between;
            }
            
            .control-group select,
            .control-group input {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .font-size-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .font-size-item input[type="number"] {
                width: 100%;
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .input-with-font-size {
                flex-direction: column;
                gap: 10px;
            }
            
            .font-size-control {
                width: 100%;
                justify-content: center;
            }
            
            .font-size-control input[type="number"] {
                width: 80px;
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
        }


@media (max-width: 768px) {
    .main-title {
        font-size: 26px;
        line-height: 1.4;
        text-align: center;
        padding: 0 10px;
    }

    .subtitle {
        font-size: 16px;
        line-height: 1.6;
        text-align: center;
        padding: 0 10px;
    }

    .company-intro p {
        font-size: 14px;
        text-indent: 1.5em;
        padding: 0 10px;
    }

    .project-section {
        margin-bottom: 40px;
    }

    .image-container {
        margin: 20px 0;
    }

    .image-caption {
        font-size: 14px;
        padding: 8px 10px;
    }

    .project-image {
        width: 100%;
        max-width: 100%;
        height: auto;
        border-radius: 8px;
    }

    .container {
        padding: 16px;
    }
}
</style>
</head>
<body>
<div class="container">
<!-- 使用说明 -->
<div class="instructions">
<h3>使用说明</h3>
<ul>
<li><strong>推荐操作顺序：</strong>按一、二、三、四的顺序依次完成设置</li>
<li><strong>文案输入：</strong>优先使用手动输入，也可以选择txt文件自动填充。标题和副标题支持换行显示</li>
<li><strong>字体设置：</strong>每个输入框右侧都有对应的字体大小设置</li>
<li><strong>图片板块设置：</strong>输入需要的板块数量后，点击"更新图片选择框"生成对应数量的选择框</li>
<li><strong>图片多选功能：</strong>每个"项目图片 X"都支持多选，选</li></ul></div></div></body></html>