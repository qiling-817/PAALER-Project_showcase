<li><strong>å›¾ç‰‡å¤šé€‰åŠŸèƒ½ï¼š</strong>æ¯ä¸ª"é¡¹ç›®å›¾ç‰‡ X"éƒ½æ”¯æŒå¤šé€‰ï¼Œé€‰ä¸­çš„å›¾ç‰‡ä¼šç»„æˆä¸€ä¸ªå›¾ç‰‡ç»„æ˜¾ç¤º</li>
<li><strong>å›¾ç‰‡åç§°ç¼–è¾‘ï¼š</strong>é€‰æ‹©å›¾ç‰‡åï¼Œå¯ä»¥åœ¨ä¸‹æ–¹çš„æ–‡æœ¬æ¡†ä¸­ç¼–è¾‘æ¯å¼ å›¾ç‰‡çš„æ˜¾ç¤ºåç§°</li>
<li><strong>æ°´å°è®¾ç½®ï¼š</strong>å¯ä»¥è°ƒæ•´æ°´å°å¤§å°æ¨¡å¼ã€ä½ç½®ã€é€æ˜åº¦ç­‰</li>
<li><strong>ç”Ÿæˆå¯¼å‡ºï¼š</strong>ç‚¹å‡»"ç”Ÿæˆé¢„è§ˆ"æŸ¥çœ‹æ•ˆæœï¼Œæ»¡æ„åç‚¹å‡»"å¯¼å‡ºä¸ºå›¾ç‰‡"ï¼ˆè‡ªåŠ¨å‹ç¼©è‡³10MBä»¥å†…ï¼‰</li>


<!-- æ–‡ä»¶é€‰æ‹©æ§åˆ¶åŒºåŸŸ -->
<div class="file-controls">
<!-- ä¸€ã€é¡¹ç›®æ–‡æ¡ˆå†…å®¹ -->
<div class="manual-input-section">
<h4>ğŸ“ ä¸€ã€é¡¹ç›®æ–‡æ¡ˆå†…å®¹</h4>
<div class="file-input-group">
<label for="manualTitle">1ã€é¡¹ç›®æ ‡é¢˜ï¼ˆæ”¯æŒæ¢è¡Œï¼‰ï¼š</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualTitle" placeholder="è¯·è¾“å…¥é¡¹ç›®æ ‡é¢˜ï¼Œå¯æ¢è¡Œæ˜¾ç¤º" rows="2"></textarea>
</div>
<div class="font-size-control">
<label>å­—ä½“:</label>
<input id="titleFontSize" max="120" min="20" type="number" value="82"/>
<span>px</span>
</div>
</div>
</div>
<div class="file-input-group">
<label for="manualSubtitle">2ã€é¡¹ç›®å‰¯æ ‡é¢˜ï¼ˆæ”¯æŒæ¢è¡Œï¼‰ï¼š</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualSubtitle" placeholder="è¯·è¾“å…¥é¡¹ç›®å‰¯æ ‡é¢˜ï¼ˆæ”¯æŒå¤šè¡Œï¼‰" rows="3"></textarea>
</div>
<div class="font-size-control">
<label>å­—ä½“:</label>
<input id="subtitleFontSize" max="80" min="14" type="number" value="53"/>
<span>px</span>
</div>
</div>
</div>
<div class="file-input-group">
<label for="manualIntro">3ã€ä¼ä¸šä»‹ç»ï¼ˆæ¯æ®µè‡ªåŠ¨é¦–è¡Œç¼©è¿›ï¼‰ï¼š</label>
<div class="input-with-font-size">
<div class="main-input">
<textarea id="manualIntro" placeholder="è¯·è¾“å…¥ä¼ä¸šä»‹ç»å†…å®¹ï¼Œæ”¯æŒå¤šæ®µè½ï¼Œæ¯æ®µä¼šè‡ªåŠ¨é¦–è¡Œç¼©è¿›" rows="5"></textarea>
</div>
<div class="font-size-control">
<label>å­—ä½“:</label>
<input id="introFontSize" max="70" min="12" type="number" value="51"/>
<span>px</span>
</div>
</div>
</div>
<!-- 4ã€æˆ–è€…é€‰æ‹©txtæ–‡ä»¶ -->
<div class="txt-file-section">
<h4>4ã€æˆ–è€…é€‰æ‹©txtæ–‡ä»¶è‡ªåŠ¨å¡«å……ä¸Šé¢çš„å†…å®¹</h4>
<div style="display: flex; align-items: center; gap: 10px;">
<input accept=".txt" id="textFile" style="flex: 1;" type="file"/>
<button class="auto-fill-btn" onclick="autoFillFromTxt()">è‡ªåŠ¨å¡«å……</button>
</div>
</div>
</div>
<!-- äºŒã€é€‰æ‹©Logoå›¾ç‰‡ -->
<div class="font-size-controls">
<h4>ğŸ“· äºŒã€é€‰æ‹©Logoå›¾ç‰‡ï¼ˆæ™ºèƒ½è°ƒæ•´å°ºå¯¸ï¼‰</h4>
<div class="file-input-group">
<input accept="image/*" id="logoFiles" multiple="" type="file"/>
</div>
</div>
<!-- ä¸‰ã€é¡¹ç›®å›¾ç‰‡è®¾ç½® -->
<div class="font-size-controls">
<h4>ğŸ–¼ï¸ ä¸‰ã€é¡¹ç›®å›¾ç‰‡è®¾ç½®</h4>
<div class="font-size-item">
<label>å›¾ç‰‡æ¿å—æ•°é‡ï¼š</label>
<input id="imageBlockCount" max="10" min="1" type="number" value="1"/>
<span>ä¸ªï¼ˆè®¾ç½®éœ€è¦æ˜¾ç¤ºå‡ ä¸ªå›¾ç‰‡æ¿å—ï¼‰</span>
</div>
<button class="auto-fill-btn" onclick="generateImageInputs()" style="margin-left: 0;">ğŸ”„ æ›´æ–°å›¾ç‰‡é€‰æ‹©æ¡†</button>
<!-- å›¾ç‰‡è¯´æ˜å­—ä½“å¤§å°è®¾ç½® -->
<div class="font-size-item" style="margin-top: 15px;">
<label>å›¾ç‰‡è¯´æ˜å­—ä½“ï¼š</label>
<input id="captionFontSize" max="60" min="12" type="number" value="51"/>
<span>px</span>
</div>
</div>
<!-- åŠ¨æ€ç”Ÿæˆçš„å›¾ç‰‡é€‰æ‹©åŒºåŸŸ -->
<div id="dynamicImageInputs">
<!-- è¿™é‡Œä¼šåŠ¨æ€ç”Ÿæˆå›¾ç‰‡é€‰æ‹©æ¡† -->
</div>
<!-- å››ã€æ°´å°æ§åˆ¶åŒºåŸŸ -->
<div class="watermark-controls">
<h4>ğŸ·ï¸ å››ã€æ°´å°è®¾ç½®</h4>
<div class="file-input-group">
<label for="watermarkFile">é€‰æ‹©æ°´å°å›¾ç‰‡ï¼š</label>
<input accept="image/*" id="watermarkFile" type="file"/>
</div>
<div class="watermark-control-row">
<div class="control-group">
<label for="watermarkMode">å¤§å°æ¨¡å¼ï¼š</label>
<select id="watermarkMode">
<option value="fit">é€‚åˆå¡«å……</option>
<option value="fill">æ‹‰ä¼¸å¡«å……</option>
<option value="small">å°å°ºå¯¸</option>
<option value="medium">ä¸­ç­‰å°ºå¯¸</option>
<option value="large">å¤§å°ºå¯¸</option>
</select>
</div>
<div class="control-group">
<label for="watermarkPosition">ä½ç½®ï¼š</label>
<select id="watermarkPosition">
<option value="center">å±…ä¸­</option>
<option value="top-left">å·¦ä¸Šè§’</option>
<option value="top-right">å³ä¸Šè§’</option>
<option value="bottom-left">å·¦ä¸‹è§’</option>
<option value="bottom-right">å³ä¸‹è§’</option>
</select>
</div>
<div class="control-group">
<label for="watermarkOpacity">é€æ˜åº¦ï¼š</label>
<input id="watermarkOpacity" max="100" min="0" type="range" value="30"/>
<span class="opacity-display" id="opacityDisplay">30%</span>
</div>
</div>
</div>
<div class="button-group">
<button class="refresh-btn" onclick="loadContent()">ğŸ”„ ç”Ÿæˆé¢„è§ˆ</button>
<div class="export-options">
<label for="exportQuality">å¯¼å‡ºè´¨é‡ï¼š</label>
<select id="exportQuality">
<option value="3">ä½è´¨é‡ï¼ˆ3MBä»¥å†…ï¼‰</option>
<option selected="" value="5">ä¸­è´¨é‡ï¼ˆ5MBä»¥å†…ï¼‰</option>
<option value="10">é«˜è´¨é‡ï¼ˆ10MBä»¥å†…ï¼‰</option>
<option value="20">è¶…é«˜è´¨é‡ï¼ˆ20MBä»¥å†…ï¼‰</option>
<option value="custom">è‡ªå®šä¹‰å¤§å°</option>
</select>
<input id="customSize" max="50" min="1" placeholder="MB" style="width: 80px; margin-left: 10px; display: none;" type="number" value="8"/>
<span id="customLabel" style="display: none; margin-left: 5px;">MB</span>
</div>
<button class="export-btn" disabled="" id="exportBtn" onclick="exportAsImage()">ğŸ’¾ å¯¼å‡ºä¸ºå›¾ç‰‡</button>
</div>
<div class="export-status" id="exportStatus" style="display: none;"></div>
</div>
<!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
<div id="main-content">
<div class="loading">è¯·å¡«å†™æ–‡æ¡ˆå†…å®¹ï¼Œé€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»"ç”Ÿæˆé¢„è§ˆ"æŒ‰é’®</div>
</div>

<!-- å¼•å…¥html2canvasåº“ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
        // å…¨å±€å˜é‡
        let projectData = {
            title: '',
            subtitle: '',
            companyIntro: '',
            logos: [],
            projectImages: [],
            watermark: null,
            watermarkOpacity: 30,
            watermarkMode: 'fit',
            watermarkPosition: 'center',
            imageBlockCount: 1,
            fontSizes: {
                title: 82,
                subtitle: 53,
                intro: 51,
                caption: 51
            },
            imageNames: [],
            imageFiles: []
        };

        // å›¾ç‰‡å‹ç¼©å‡½æ•°
        function compressImage(canvas, maxSize = 10 * 1024 * 1024) {
            let quality = 0.9;
            let compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
            
            function getDataUrlSize(dataUrl) {
                return Math.round((dataUrl.length - 22) * 3 / 4);
            }
            
            while (getDataUrlSize(compressedDataUrl) > maxSize && quality > 0.1) {
                quality -= 0.1;
                compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
            }
            
            if (getDataUrlSize(compressedDataUrl) > maxSize) {
                const scale = Math.sqrt(maxSize / getDataUrlSize(compressedDataUrl));
                const newWidth = Math.floor(canvas.width * scale);
                const newHeight = Math.floor(canvas.height * scale);
                
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = newWidth;
                tempCanvas.height = newHeight;
                
                tempCtx.drawImage(canvas, 0, 0, newWidth, newHeight);
                compressedDataUrl = tempCanvas.toDataURL('image/jpeg', 0.9);
            }
            
            return compressedDataUrl;
        }

        // æ™ºèƒ½è°ƒæ•´Logoå°ºå¯¸
        function adjustLogoSize(img) {
            const aspectRatio = img.naturalWidth / img.naturalHeight;
            
            if (aspectRatio > 1.2) {
                img.style.width = '800px';
                img.style.height = 'auto';
            } else if (aspectRatio < 0.8) {
                img.style.height = '800px';
                img.style.width = 'auto';
            } else {
                img.style.maxWidth = '800px';
                img.style.maxHeight = '800px';
            }
        }

        // è¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹
        function readTextFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    resolve(e.target.result);
                };
                reader.onerror = reject;
                reader.readAsText(file, 'UTF-8');
            });
        }

        // è¯»å–å›¾ç‰‡æ–‡ä»¶
        function readImageFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const nameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
                    resolve({
                        name: nameWithoutExtension,
                        src: e.target.result
                    });
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // è§£ææ–‡æ¡ˆæ–‡ä»¶
        function parseTextContent(content) {
            const lines = content.split('\n');
            const data = {};
            
            let currentSection = null;
            let subtitleParts = [];
            let introParts = [];
            
            lines.forEach(line => {
                const trimmedLine = line.trim();
                
                if (trimmedLine.includes('ã€é¡¹ç›®æ ‡é¢˜ã€‘:') || trimmedLine.includes('ã€é¡¹ç›®æ ‡é¢˜ã€‘ï¼š')) {
                    const colonIndex = trimmedLine.search(/[ï¼š:]/);
                    data.title = trimmedLine.substring(colonIndex + 1).trim();
                    currentSection = 'title';
                } 
                else if (trimmedLine.includes('ã€é¡¹ç›®å‰¯æ ‡é¢˜ã€‘:') || trimmedLine.includes('ã€é¡¹ç›®å‰¯æ ‡é¢˜ã€‘ï¼š')) {
                    const colonIndex = trimmedLine.search(/[ï¼š:]/);
                    const subtitleContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (subtitleContent) {
                        subtitleParts.push(subtitleContent);
                    }
                    currentSection = 'subtitle';
                } 
                else if (trimmedLine.includes('ã€ä»‹ç»å†…å®¹ã€‘:') || trimmedLine.includes('ã€ä»‹ç»å†…å®¹ã€‘ï¼š')) {
                    const colonIndex = trimmedLine.search(/[ï¼š:]/);
                    const introContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (introContent) {
                        introParts.push(introContent);
                    }
                    currentSection = 'intro';
                }
                else if (trimmedLine.includes('æ ‡é¢˜:') || trimmedLine.includes('ä¸»æ ‡é¢˜:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    data.title = trimmedLine.substring(colonIndex + 1).trim();
                    currentSection = 'title';
                } 
                else if (trimmedLine.includes('å‰¯æ ‡é¢˜:') || trimmedLine.includes('å­æ ‡é¢˜:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    const subtitleContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (subtitleContent) {
                        subtitleParts.push(subtitleContent);
                    }
                    currentSection = 'subtitle';
                } 
                else if (trimmedLine.includes('ä¼ä¸šä»‹ç»:') || trimmedLine.includes('å…¬å¸ä»‹ç»:') || trimmedLine.includes('ä»‹ç»:')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    const introContent = trimmedLine.substring(colonIndex + 1).trim();
                    if (introContent) {
                        introParts.push(introContent);
                    }
                    currentSection = 'intro';
                }
                else if (currentSection === 'subtitle' && trimmedLine && !trimmedLine.includes('ã€') && !trimmedLine.includes(':')) {
                    subtitleParts.push(trimmedLine);
                }
                else if (currentSection === 'intro' && !trimmedLine.includes('ã€') && !trimmedLine.includes(':')) {
                    if (trimmedLine === '' && introParts.length > 0) {
                        introParts.push('\n');
                    } else if (trimmedLine) {
                        introParts.push(trimmedLine);
                    }
                }
            });

            if (subtitleParts.length > 0) {
                data.subtitle = subtitleParts.join('\n');
            }

            if (introParts.length > 0) {
                data.companyIntro = introParts.join('\n');
            }

            if (!data.title && lines.length > 0) {
                data.title = lines[0].trim();
            }
            if (!data.subtitle && lines.length > 1) {
                data.subtitle = lines[1].trim();
            }
            if (!data.companyIntro && lines.length > 2) {
                data.companyIntro = lines.slice(2).join('\n');
            }

            return data;
        }

        // ç”ŸæˆåŠ¨æ€å›¾ç‰‡è¾“å…¥æ¡†
        function generateImageInputs() {
            const count = parseInt(document.getElementById('imageBlockCount').value);
            const container = document.getElementById('dynamicImageInputs');
            
            let html = '<h4 style="color: #0056b3; margin: 15px 0 10px 0;">ğŸ“¸ é¡¹ç›®å›¾ç‰‡é€‰æ‹©</h4>';
            
            for (let i = 1; i <= count; i++) {
                html += `
                    <div class="file-input-group">
                        <label for="projectImage${i}">é¡¹ç›®å›¾ç‰‡ ${i}ï¼š</label>
                        <input type="file" id="projectImage${i}" accept="image/*" multiple onchange="previewImage(${i})">
                        <div id="preview${i}" style="margin-top: 5px; font-size: 12px; color: #666;"></div>
                        <div id="imageNames${i}" class="image-name-edit" style="display: none;">
                            <div class="image-preview-header">ğŸ“ ç¼–è¾‘å›¾ç‰‡åç§°ï¼š</div>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
            projectData.imageBlockCount = count;
        }

        // é¢„è§ˆé€‰æ‹©çš„å›¾ç‰‡å¹¶ç”Ÿæˆåç§°ç¼–è¾‘æ¡†
        function previewImage(index) {
            const fileInput = document.getElementById(`projectImage${index}`);
            const preview = document.getElementById(`preview${index}`);
            const imageNamesContainer = document.getElementById(`imageNames${index}`);
            
            if (fileInput.files && fileInput.files.length > 0) {
                let fileNames = [];
                let nameEditHTML = '<div class="image-preview-header">ğŸ“ ç¼–è¾‘å›¾ç‰‡åç§°ï¼ˆå¯æ‹–æ‹½æ’åºï¼‰ï¼š</div>';
                
                if (!projectData.imageFiles[index - 1]) {
                    projectData.imageFiles[index - 1] = [];
                }
                projectData.imageFiles[index - 1] = Array.from(fileInput.files);
                
                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const nameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
                    fileNames.push(nameWithoutExtension);
                    
                    const previewUrl = URL.createObjectURL(file);
                    
                    nameEditHTML += `
                        <div class="image-name-item" draggable="true" data-index="${i}" 
                             ondragstart="handleDragStart(event, ${index})" 
                             ondragover="handleDragOver(event)" 
                             ondrop="handleDrop(event, ${index})"
                             ondragend="handleDragEnd(event)">
                            <span class="drag-handle">â‹®â‹®</span>
                            <img src="${previewUrl}" alt="é¢„è§ˆ" class="image-preview-thumb">
                            <label>å›¾ç‰‡${i + 1}:</label>
                            <input type="text" id="imageName${index}_${i}" value="${nameWithoutExtension}" 
                                   placeholder="è¾“å…¥å›¾ç‰‡æ˜¾ç¤ºåç§°" onchange="updateImageName(${index}, ${i})"
                                   style="flex: 1;">
                            <button onclick="removeImage(${index}, ${i})">åˆ é™¤</button>
                        </div>
                    `;
                }
                
                if (fileNames.length === 1) {
                    preview.innerHTML = `âœ… å·²é€‰æ‹©: ${fileNames[0]}`;
                } else {
                    preview.innerHTML = `âœ… å·²é€‰æ‹© ${fileNames.length} ä¸ªæ–‡ä»¶: ${fileNames.join(', ')}`;
                }
                preview.style.color = '#28a745';
                
                imageNamesContainer.innerHTML = nameEditHTML;
                imageNamesContainer.style.display = 'block';
                
                if (!projectData.imageNames[index - 1]) {
                    projectData.imageNames[index - 1] = [];
                }
                projectData.imageNames[index - 1] = fileNames.slice();
                
            } else {
                preview.innerHTML = '';
                imageNamesContainer.style.display = 'none';
                if (projectData.imageFiles[index - 1]) {
                    projectData.imageFiles[index - 1].forEach(file => {
                        if (file.previewUrl) {
                            URL.revokeObjectURL(file.previewUrl);
                        }
                    });
                }
            }
        }

        // æ‹–æ‹½æ’åºç›¸å…³å‡½æ•°
        let draggedElement = null;
        let draggedIndex = null;
        let draggedBlockIndex = null;

        function handleDragStart(event, blockIndex) {
            draggedElement = event.target.closest('.image-name-item');
            draggedIndex = parseInt(draggedElement.getAttribute('data-index'));
            draggedBlockIndex = blockIndex;
            draggedElement.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
        }

        function handleDrop(event, blockIndex) {
            event.preventDefault();
            
            if (blockIndex !== draggedBlockIndex) return;
            
            const targetElement = event.target.closest('.image-name-item');
            if (!targetElement || targetElement === draggedElement) return;
            
            const targetIndex = parseInt(targetElement.getAttribute('data-index'));
            
            const imageFiles = projectData.imageFiles[blockIndex - 1];
            const imageNames = projectData.imageNames[blockIndex - 1];
            
            if (imageFiles && imageNames) {
                const movedFile = imageFiles.splice(draggedIndex, 1)[0];
                const movedName = imageNames.splice(draggedIndex, 1)[0];
                
                imageFiles.splice(targetIndex, 0, movedFile);
                imageNames.splice(targetIndex, 0, movedName);
                
                regenerateImagePreview(blockIndex);
            }
        }

        function handleDragEnd(event) {
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
            }
            draggedElement = null;
            draggedIndex = null;
            draggedBlockIndex = null;
        }

        // é‡æ–°ç”Ÿæˆå›¾ç‰‡é¢„è§ˆ
        function regenerateImagePreview(blockIndex) {
            const imageNamesContainer = document.getElementById(`imageNames${blockIndex}`);
            const imageFiles = projectData.imageFiles[blockIndex - 1];
            const imageNames = projectData.imageNames[blockIndex - 1];
            
            if (!imageFiles || !imageNames) return;
            
            let nameEditHTML = '<div class="image-preview-header">ğŸ“ ç¼–è¾‘å›¾ç‰‡åç§°ï¼ˆå¯æ‹–æ‹½æ’åºï¼‰ï¼š</div>';
            
            for (let i = 0; i < imageFiles.length; i++) {
                const file = imageFiles[i];
                const name = imageNames[i];
                const previewUrl = URL.createObjectURL(file);
                
                nameEditHTML += `
                    <div class="image-name-item" draggable="true" data-index="${i}" 
                         ondragstart="handleDragStart(event, ${blockIndex})" 
                         ondragover="handleDragOver(event)" 
                         ondrop="handleDrop(event, ${blockIndex})"
                         ondragend="handleDragEnd(event)">
                        <span class="drag-handle">â‹®â‹®</span>
                        <img src="${previewUrl}" alt="é¢„è§ˆ" class="image-preview-thumb">
                        <label>å›¾ç‰‡${i + 1}:</label>
                        <input type="text" id="imageName${blockIndex}_${i}" value="${name}" 
                               placeholder="è¾“å…¥å›¾ç‰‡æ˜¾ç¤ºåç§°" onchange="updateImageName(${blockIndex}, ${i})"
                               style="flex: 1;">
                        <button onclick="removeImage(${blockIndex}, ${i})">åˆ é™¤</button>
                    </div>
                `;
            }
            
            imageNamesContainer.innerHTML = nameEditHTML;
        }

        // åˆ é™¤å›¾ç‰‡
        function removeImage(blockIndex, imageIndex) {
            const files = projectData.imageFiles[blockIndex - 1];
            const names = projectData.imageNames[blockIndex - 1];

            if (files && imageIndex < files.length) {
                files.splice(imageIndex, 1);
                names.splice(imageIndex, 1);
            }

            regenerateImagePreview(blockIndex);
            
            const preview = document.getElementById(`preview${blockIndex}`);
            if (files.length > 0) {
                preview.innerHTML = `âœ… å½“å‰å…± ${files.length} å¼ å›¾ç‰‡`;
            } else {
                preview.innerHTML = '';
                document.getElementById(`imageNames${blockIndex}`).style.display = 'none';
            }
        }

        // æ›´æ–°å›¾ç‰‡åç§°
        function updateImageName(blockIndex, imageIndex) {
            const nameInput = document.getElementById(`imageName${blockIndex}_${imageIndex}`);
            if (nameInput && projectData.imageNames[blockIndex - 1]) {
                projectData.imageNames[blockIndex - 1][imageIndex] = nameInput.value.trim() || `å›¾ç‰‡${imageIndex + 1}`;
            }
        }

        // è·å–æ‰‹åŠ¨è¾“å…¥çš„å†…å®¹
        function getManualContent() {
            return {
                title: document.getElementById('manualTitle').value.trim(),
                subtitle: document.getElementById('manualSubtitle').value.trim(),
                companyIntro: document.getElementById('manualIntro').value.trim()
            };
        }

        // ä»txtæ–‡ä»¶è‡ªåŠ¨å¡«å……å†…å®¹
        async function autoFillFromTxt() {
            const textFile = document.getElementById('textFile').files[0];
            if (!textFile) {
                return;
            }

            try {
                const textContent = await readTextFile(textFile);
                const parsedData = parseTextContent(textContent);
                
                document.getElementById('manualTitle').value = parsedData.title || '';
                document.getElementById('manualSubtitle').value = parsedData.subtitle || '';
                document.getElementById('manualIntro').value = parsedData.companyIntro || '';
                
                setTimeout(() => {
                    const hint = document.createElement('div');
                    hint.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #4caf50; color: white; padding: 10px 15px; border-radius: 5px; z-index: 1000; font-size: 14px;';
                    hint.textContent = 'âœ… æ–‡æ¡ˆå†…å®¹å·²è‡ªåŠ¨å¡«å……å®Œæˆï¼';
                    document.body.appendChild(hint);
                    
                    setTimeout(() => {
                        document.body.removeChild(hint);
                    }, 2000);
                }, 100);
                
            } catch (error) {
                console.error('è¯»å–txtæ–‡ä»¶æ—¶å‡ºé”™:', error);
                const errorHint = document.createElement('div');
                errorHint.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #f44336; color: white; padding: 10px 15px; border-radius: 5px; z-index: 1000; font-size: 14px;';
                errorHint.textContent = 'âŒ è¯»å–txtæ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼';
                document.body.appendChild(errorHint);
                
                setTimeout(() => {
                    document.body.removeChild(errorHint);
                }, 3000);
            }
        }

        // åŠ è½½å†…å®¹
        async function loadContent() {
            const logoFiles = document.getElementById('logoFiles').files;
            const watermarkFile = document.getElementById('watermarkFile').files[0];
            
            const mainContent = document.getElementById('main-content');
            const exportBtn = document.getElementById('exportBtn');
            const exportStatus = document.getElementById('exportStatus');
            
            mainContent.innerHTML = '<div class="loading">æ­£åœ¨ç”Ÿæˆé¢„è§ˆ...</div>';
            exportBtn.disabled = true;
            exportStatus.style.display = 'none';

            try {
                projectData.fontSizes.title = parseInt(document.getElementById('titleFontSize').value);
                projectData.fontSizes.subtitle = parseInt(document.getElementById('subtitleFontSize').value);
                projectData.fontSizes.intro = parseInt(document.getElementById('introFontSize').value);
                projectData.fontSizes.caption = parseInt(document.getElementById('captionFontSize').value);
                projectData.watermarkMode = document.getElementById('watermarkMode').value;
                projectData.watermarkPosition = document.getElementById('watermarkPosition').value;
                projectData.watermarkOpacity = parseInt(document.getElementById('watermarkOpacity').value);
                projectData.imageBlockCount = parseInt(document.getElementById('imageBlockCount').value);

                const manualContent = getManualContent();
                projectData.title = manualContent.title || 'è¯·è¾“å…¥é¡¹ç›®æ ‡é¢˜';
                projectData.subtitle = manualContent.subtitle || 'è¯·è¾“å…¥é¡¹ç›®å‰¯æ ‡é¢˜';
                projectData.companyIntro = manualContent.companyIntro || 'è¯·è¾“å…¥ä¼ä¸šä»‹ç»å†…å®¹';

                projectData.logos = [];
                if (logoFiles.length > 0) {
                    for (let file of logoFiles) {
                        const imageData = await readImageFile(file);
                        projectData.logos.push(imageData);
                    }
                }

                projectData.projectImages = [];
                const blockCount = projectData.imageBlockCount;
                
                for (let i = 1; i <= blockCount; i++) {
                    if (projectData.imageFiles[i - 1] && projectData.imageFiles[i - 1].length > 0) {
                        const blockImages = [];
                        for (let j = 0; j < projectData.imageFiles[i - 1].length; j++) {
                            const file = projectData.imageFiles[i - 1][j];
                            const imageData = await readImageFile(file);
                            if (projectData.imageNames[i - 1] && projectData.imageNames[i - 1][j]) {
                                imageData.name = projectData.imageNames[i - 1][j];
                            }
                            blockImages.push(imageData);
                        }
                        projectData.projectImages.push(blockImages);
                    } else {
                        const fileInput = document.getElementById(`projectImage${i}`);
                        if (fileInput && fileInput.files && fileInput.files.length > 0) {
                            const blockImages = [];
                            for (let j = 0; j < fileInput.files.length; j++) {
                                const imageData = await readImageFile(fileInput.files[j]);
                                if (projectData.imageNames[i - 1] && projectData.imageNames[i - 1][j]) {
                                    imageData.name = projectData.imageNames[i - 1][j];
                                }
                                blockImages.push(imageData);
                            }
                            projectData.projectImages.push(blockImages);
                        } else {
                            projectData.projectImages.push([]);
                        }
                    }
                }

                if (watermarkFile) {
                    projectData.watermark = await readImageFile(watermarkFile);
                }

                renderContent();
                exportBtn.disabled = false;
                
            } catch (error) {
                console.error('ç”Ÿæˆé¢„è§ˆæ—¶å‡ºé”™:', error);
                mainContent.innerHTML = '<div class="error">ç”Ÿæˆé¢„è§ˆæ—¶å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå†…å®¹ã€‚</div>';
                exportBtn.disabled = true;
            }
        }

        // æ¸²æŸ“å†…å®¹
        function renderContent() {
            const mainContent = document.getElementById('main-content');
            
            let html = `
                <div class="header">
                    <h1 class="main-title" style="font-size: ${projectData.fontSizes.title}px;">${projectData.title}</h1>
                    <p class="subtitle" style="font-size: ${projectData.fontSizes.subtitle}px;">${projectData.subtitle}</p>
                </div>

                <div class="logo-section">
                    ${projectData.logos.map(logo => `
                        <div class="logo-container">
                            <img src="${logo.src}" alt="${logo.name}" onload="adjustLogoSize(this)">
                        </div>
                    `).join('')}
                </div>

                <div class="company-intro">
                    ${formatCompanyIntro(projectData.companyIntro, projectData.fontSizes.intro)}
                </div>

                <div class="project-showcase">
                    ${generateImageBlocks()}
                </div>
            `;

            mainContent.innerHTML = html;

            if (projectData.watermark) {
                setTimeout(() => {
                    drawWatermarks();
                }, 100);
            }
        }

        // æ ¼å¼åŒ–ä¼ä¸šä»‹ç»ï¼Œæ”¯æŒåˆ†æ®µå’Œé¦–è¡Œç¼©è¿›
        function formatCompanyIntro(content, fontSize) {
            const paragraphs = content.split('\n').filter(p => p.trim());
            return paragraphs.map(paragraph => 
                `<p style="font-size: ${fontSize}px;">${paragraph}</p>`
            ).join('');
        }

        // ç”Ÿæˆå›¾ç‰‡æ¿å—
        function generateImageBlocks() {
            let blocks = '';
            const blockCount = projectData.imageBlockCount;
            
            for (let i = 0; i < blockCount; i++) {
                const blockImages = projectData.projectImages[i];
                
                // ç§»é™¤åˆ†å‰²çº¿ç”Ÿæˆä»£ç 
                blocks += '<div class="project-section">';
                
                if (blockImages && blockImages.length > 0) {
                    blockImages.forEach((image, imageIndex) => {
                        blocks += `
                            <div class="image-container">
                                <div class="image-with-watermark">
                                    <img src="${image.src}" alt="é¡¹ç›®å›¾ç‰‡${i + 1}-${imageIndex + 1}" class="project-image">
                                    ${projectData.watermark ? `
                                        <canvas class="watermark-overlay" data-image-index="${i}-${imageIndex}"></canvas>
                                    ` : ''}
                                </div>
                                <div class="image-caption" style="font-size: ${projectData.fontSizes.caption}px;">${image.name}</div>
                            </div>
                        `;
                    });
                } else {
                    blocks += `
                        <div class="image-placeholder">
                            <div class="placeholder-content">
                                <div style="text-align: center;">
                                    <div class="placeholder-icon">ğŸ–¼ï¸</div>
                                    <div class="placeholder-text">
                                        <div>å›¾ç‰‡ç»„ ${i + 1}</div>
                                        <div class="placeholder-subtitle">ç­‰å¾…é€‰æ‹©å›¾ç‰‡ï¼ˆå¯å¤šé€‰ï¼‰</div>
                                    </div>
                                </div>
                            </div>
                            <div class="image-caption" style="font-size: ${projectData.fontSizes.caption}px;">å›¾ç‰‡ç»„ ${i + 1}</div>
                        </div>
                    `;
                }
                
                blocks += '</div>';
            }
            
            return blocks;
        }

        // è®¡ç®—æ°´å°å°ºå¯¸å’Œä½ç½®
        function calculateWatermarkDimensions(canvasWidth, canvasHeight, watermarkImg, mode) {
            let width, height, x, y;
            
            switch (mode) {
                case 'fit':
                    const scale = Math.max(canvasWidth / watermarkImg.width, canvasHeight / watermarkImg.height);
                    width = watermarkImg.width * scale;
                    height = watermarkImg.height * scale;
                    break;
                case 'fill':
                    width = canvasWidth;
                    height = canvasHeight;
                    break;
                case 'small':
                    width = canvasWidth * 0.2;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                case 'medium':
                    width = canvasWidth * 0.4;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                case 'large':
                    width = canvasWidth * 0.6;
                    height = (watermarkImg.height / watermarkImg.width) * width;
                    break;
                default:
                    width = canvasWidth * 0.3;
                    height = (watermarkImg.height / watermarkImg.width) * width;
            }
            
            switch (projectData.watermarkPosition) {
                case 'top-left':
                    x = 20;
                    y = 20;
                    break;
                case 'top-right':
                    x = canvasWidth - width - 20;
                    y = 20;
                    break;
                case 'bottom-left':
                    x = 20;
                    y = canvasHeight - height - 20;
                    break;
                case 'bottom-right':
                    x = canvasWidth - width - 20;
                    y = canvasHeight - height - 20;
                    break;
                case 'center':
                default:
                    x = (canvasWidth - width) / 2;
                    y = (canvasHeight - height) / 2;
                    break;
            }
            
            return { width, height, x, y };
        }

        // ç»˜åˆ¶æ°´å°
        function drawWatermarks() {
            const watermarkCanvases = document.querySelectorAll('.watermark-overlay');
            
            watermarkCanvases.forEach((canvas) => {
                const projectImage = canvas.previousElementSibling;
                
                if (projectImage.complete) {
                    drawWatermarkOnCanvas(canvas, projectImage, projectData.watermark);
                } else {
                    projectImage.onload = () => {
                        drawWatermarkOnCanvas(canvas, projectImage, projectData.watermark);
                    };
                }
            });
        }

        // åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶æ°´å°
        function drawWatermarkOnCanvas(canvas, projectImage, watermark) {
            const ctx = canvas.getContext('2d');
            
            canvas.width = projectImage.offsetWidth;
            canvas.height = projectImage.offsetHeight;
            
            const watermarkImg = new Image();
            watermarkImg.onload = () => {
                const dimensions = calculateWatermarkDimensions(
                    canvas.width, 
                    canvas.height, 
                    watermarkImg, 
                    projectData.watermarkMode
                );
                
                ctx.globalAlpha = projectData.watermarkOpacity / 100;
                ctx.drawImage(watermarkImg, dimensions.x, dimensions.y, dimensions.width, dimensions.height);
            };
            
            watermarkImg.src = watermark.src;
        }

        // å¯¼å‡ºä¸ºå›¾ç‰‡ï¼ˆå›ºå®š1080pxå®½åº¦ï¼Œä¸å—è®¾å¤‡å½±å“ï¼‰
        async function exportAsImage() {
            const exportBtn = document.getElementById('exportBtn');
            const exportStatus = document.getElementById('exportStatus');
            const mainContent = document.getElementById('main-content');
            
            // è·å–ç”¨æˆ·é€‰æ‹©çš„å‹ç¼©å¤§å°
            const qualitySelect = document.getElementById('exportQuality');
            const customSizeInput = document.getElementById('customSize');
            let maxSizeMB;
            
            if (qualitySelect.value === 'custom') {
                maxSizeMB = parseInt(customSizeInput.value) || 8;
            } else {
                maxSizeMB = parseInt(qualitySelect.value);
            }
            
            const maxSize = maxSizeMB * 1024 * 1024; // è½¬æ¢ä¸ºå­—èŠ‚
            
            exportBtn.disabled = true;
            exportStatus.style.display = 'block';
            exportStatus.className = 'export-status loading';
            exportStatus.textContent = `æ­£åœ¨ç”Ÿæˆå›¾ç‰‡ï¼ˆç›®æ ‡å¤§å°ï¼š${maxSizeMB}MBä»¥å†…ï¼‰...`;

            try {
                // ä¸´æ—¶è®¾ç½®å®¹å™¨ä¸ºå›ºå®š1080pxå®½åº¦è¿›è¡Œæˆªå›¾
                const originalWidth = mainContent.style.width;
                const originalMaxWidth = mainContent.style.maxWidth;
                const originalTransform = mainContent.style.transform;
                const originalOverflow = document.body.style.overflow;
                
                // å¼ºåˆ¶è®¾ç½®ä¸º1080pxå®½åº¦
                mainContent.style.width = '1080px';
                mainContent.style.maxWidth = '1080px';
                mainContent.style.transform = 'scale(1)';
                document.body.style.overflow = 'visible';
                
                // ç­‰å¾…ä¸€ä¸‹è®©DOMæ›´æ–°
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // è®¡ç®—å®é™…é«˜åº¦
                const actualHeight = mainContent.scrollHeight;
                
                const options = {
                    scale: 1,
                    useCORS: true,
                    allowTaint: false,
                    backgroundColor: '#ffffff',
                    width: 1080,
                    height: actualHeight,
                    scrollX: 0,
                    scrollY: 0,
                    x: 0,
                    y: 0
                };

                const canvas = await html2canvas(mainContent, options);
                
                // æ¢å¤åŸå§‹æ ·å¼
                mainContent.style.width = originalWidth;
                mainContent.style.maxWidth = originalMaxWidth;
                mainContent.style.transform = originalTransform;
                document.body.style.overflow = originalOverflow;
                
                // ç¡®ä¿canvasæ˜¯1080pxå®½åº¦
                let finalCanvas = canvas;
                if (canvas.width !== 1080) {
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCanvas.width = 1080;
                    tempCanvas.height = Math.round((canvas.height / canvas.width) * 1080);
                    
                    // å°†åŸcanvaså†…å®¹æŒ‰æ¯”ä¾‹ç»˜åˆ¶åˆ°1080pxå®½åº¦çš„canvasä¸Š
                    tempCtx.drawImage(canvas, 0, 0, 1080, tempCanvas.height);
                    finalCanvas = tempCanvas;
                }
                
                const compressedDataUrl = compressImage(finalCanvas, maxSize);
                
                // è·å–é¡¹ç›®æ ‡é¢˜ä½œä¸ºæ–‡ä»¶å
                const projectTitle = projectData.title || 'é¡¹ç›®å±•ç¤º';
                const cleanTitle = projectTitle.replace(/[<>:"/\\|?*\n\r]/g, '').trim();
                const qualityLabel = qualitySelect.options[qualitySelect.selectedIndex].text.split('ï¼ˆ')[0];
                
                const link = document.createElement('a');
                link.download = `${cleanTitle}_${qualityLabel}.jpg`;
                link.href = compressedDataUrl;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                const fileSizeKB = Math.round((compressedDataUrl.length - 22) * 3 / 4 / 1024);
                const fileSizeMB = (fileSizeKB / 1024).toFixed(2);
                
                exportStatus.className = 'export-status success';
                exportStatus.textContent = `å›¾ç‰‡å¯¼å‡ºæˆåŠŸï¼å°ºå¯¸: ${finalCanvas.width}x${finalCanvas.height}pxï¼Œæ–‡ä»¶å¤§å°: ${fileSizeMB}MB`;
                
                setTimeout(() => {
                    exportStatus.style.display = 'none';
                }, 5000);
                
            } catch (error) {
                console.error('å¯¼å‡ºå›¾ç‰‡æ—¶å‡ºé”™:', error);
                exportStatus.className = 'export-status error';
                exportStatus.textContent = 'å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚';
                
                // ç¡®ä¿æ¢å¤æ ·å¼
                mainContent.style.width = '';
                mainContent.style.maxWidth = '';
                mainContent.style.transform = '';
                document.body.style.overflow = '';
            } finally {
                exportBtn.disabled = false;
            }
        }

        // å¤„ç†å¯¼å‡ºè´¨é‡é€‰æ‹©å˜åŒ–
        function handleExportQualityChange() {
            const qualitySelect = document.getElementById('exportQuality');
            const customSizeInput = document.getElementById('customSize');
            const customLabel = document.getElementById('customLabel');
            
            if (qualitySelect.value === 'custom') {
                customSizeInput.style.display = 'inline-block';
                customLabel.style.display = 'inline';
            } else {
                customSizeInput.style.display = 'none';
                customLabel.style.display = 'none';
            }
        }

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            generateImageInputs();
            
            // å¯¼å‡ºè´¨é‡é€‰æ‹©ç›‘å¬å™¨
            document.getElementById('exportQuality').addEventListener('change', handleExportQualityChange);
            
            document.getElementById('watermarkOpacity').addEventListener('input', function() {
                const value = this.value;
                document.getElementById('opacityDisplay').textContent = value + '%';
                projectData.watermarkOpacity = parseInt(value);
            });

            document.getElementById('watermarkMode').addEventListener('change', function() {
                projectData.watermarkMode = this.value;
            });

            document.getElementById('watermarkPosition').addEventListener('change', function() {
                projectData.watermarkPosition = this.value;
            });

            ['titleFontSize', 'subtitleFontSize', 'introFontSize', 'captionFontSize', 'imageBlockCount'].forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    if (id === 'imageBlockCount') {
                        projectData.imageBlockCount = parseInt(this.value);
                    } else {
                        const key = id.replace('FontSize', '');
                        projectData.fontSizes[key] = parseInt(this.value);
                    }
                });
            });
        });
    </script>

<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>é¡¹ç›®å±•ç¤ºæ¨¡æ¿</title>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');

        body {
            font-family: 'Noto Sans SC', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1080px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
        }

        /* æ ‡é¢˜åŒºåŸŸ */
        .header {
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 52px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            letter-spacing: 1px;
            line-height: 1.2;
            white-space: pre-line; /* æ”¯æŒæ¢è¡Œ */
        }

        .subtitle {
            font-size: 23px;
            color: #666;
            line-height: 1.6;
            font-weight: 400;
            text-align: left;
            max-width: 1600px;
            margin: 0 auto;
            white-space: pre-line; /* æ”¯æŒæ¢è¡Œ */
        }

        /* LogoåŒºåŸŸ */
        .logo-section {
            text-align: center;
            margin: 40px 0;
            padding: 30px 0;
            /* ç§»é™¤ç°è‰²èƒŒæ™¯ */
        }

        .logo-container {
            display: inline-block;
            margin: 20px;
        }

        .logo-container img {
            max-width: 800px;
            max-height: 800px;
            height: auto;
            width: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* ä¼ä¸šä»‹ç» */
        .company-intro {
            margin: 50px 0;
            padding: 40px;
            background-color: #f8f9fa;
            border-radius: 12px;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            border-left: 5px solid #007bff;
        }

        .company-intro p {
            font-size: 21px;
            line-height: 1.8;
            color: #555;
            font-weight: 400;
            max-width: 1540px;
            margin: 0 auto 20px auto;
            text-align: left;
            text-indent: 2em; /* é¦–è¡Œç¼©è¿› */
            white-space: pre-line; /* æ”¯æŒæ¢è¡Œå’Œæ®µè½ */
        }

        .company-intro p:last-child {
            margin-bottom: 0;
        }

        /* é¡¹ç›®å±•ç¤ºåŒºåŸŸ */
        .project-showcase {
            margin-top: 60px;
        }

        .project-section {
            margin-bottom: 80px; /* æ¿å—é—´éš” */
            padding: 20px 0;
        }

        .project-section:last-child {
            margin-bottom: 20px;
        }

        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, #e0e0e0, transparent);
            margin: 40px 0;
        }

        .image-container {
            margin: 40px 0;
            text-align: center;
            position: relative;
        }

        .project-image {
            width: 100%;
            max-width: 1600px;
            height: auto;
            border-radius: 12px 12px 0 0; /* åªæœ‰ä¸Šæ–¹æœ‰åœ†è§’ */
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            margin-bottom: 0; /* å®Œå…¨è´´åˆ */
            position: relative;
            transition: transform 0.3s ease;
            display: block;
        }

        .project-image:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
        }

        .image-with-watermark {
            position: relative;
            display: inline-block;
            margin-bottom: 0; /* å®Œå…¨è´´åˆ */
        }

        .watermark-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            border-radius: 12px 12px 0 0; /* åªæœ‰ä¸Šæ–¹æœ‰åœ†è§’ */
        }

        .image-caption {
            font-size: 21px;
            color: #666;
            margin-top: 0; /* å®Œå…¨è´´åˆ */
            font-weight: 500;
            text-align: center;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            padding: 12px 20px;
            background-color: rgba(255,255,255,0.95);
            border-radius: 0 0 12px 12px; /* åªæœ‰ä¸‹æ–¹æœ‰åœ†è§’ */
            border: 1px solid #e9ecef;
            border-top: none; /* ç§»é™¤é¡¶éƒ¨è¾¹æ¡†ï¼Œä¸å›¾ç‰‡å®Œå…¨è´´åˆ */
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); /* æ·»åŠ è½»å¾®é˜´å½± */
        }

        /* å›¾ç‰‡å ä½ç¬¦æ ·å¼ä¼˜åŒ– */
        .image-placeholder {
            margin: 40px 0;
        }

        .placeholder-content {
            width: 100%; 
            max-width: 1600px; 
            height: 400px; 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #ddd; 
            border-radius: 12px 12px 0 0; /* ä¸å®é™…å›¾ç‰‡ä¿æŒä¸€è‡´ */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #999;
            font-size: 18px;
            margin-bottom: 0; /* ä¸å®é™…å›¾ç‰‡ä¿æŒä¸€è‡´ */
            transition: all 0.3s ease;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15), 0 6px 20px rgba(0,0,0,0.1); /* å¢å¼ºé˜´å½± */
        }

        .placeholder-content:hover {
            border-color: #007bff;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            box-shadow: 0 16px 48px rgba(0,0,0,0.2), 0 8px 24px rgba(0,0,0,0.15); /* hoveræ—¶æ›´å¼ºé˜´å½± */
        }

        .placeholder-icon {
            font-size: 64px; 
            margin-bottom: 15px;
            opacity: 0.6;
        }

        .placeholder-text {
            text-align: center;
        }

        .placeholder-subtitle {
            font-size: 14px; 
            margin-top: 8px;
            opacity: 0.7;
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            text-align: center;
            padding: 60px 40px;
            color: #666;
            background-color: #f8f9fa;
            border-radius: 12px;
            font-size: 18px;
        }

        .error {
            color: #e74c3c;
            text-align: center;
            padding: 30px;
            background-color: #fdf2f2;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid #e74c3c;
        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-controls {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 2px dashed #ddd;
        }

        .file-input-group {
            margin: 20px 0;
        }

        .file-input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #555;
            font-size: 15px;
        }

        .file-input-group input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: white;
            font-size: 14px;
            font-family: inherit;
        }

        .file-input-group input[type="file"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        .file-input-group input[type="text"], 
        .file-input-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: white;
            font-size: 14px;
            font-family: inherit;
        }

        .file-input-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* è¾“å…¥æ¡†å’Œå­—ä½“è®¾ç½®çš„å¯¹åº”å¸ƒå±€ */
        .input-with-font-size {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-with-font-size .main-input {
            flex: 1;
        }

        .input-with-font-size .font-size-control {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #f0f8ff;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #cce7ff;
            white-space: nowrap;
        }

        .input-with-font-size .font-size-control label {
            margin: 0;
            font-size: 12px;
            color: #0056b3;
            font-weight: 500;
        }

        .input-with-font-size .font-size-control input[type="number"] {
            width: 60px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
        }

        .input-with-font-size .font-size-control span {
            font-size: 12px;
            color: #666;
        }

        .watermark-controls {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }

        .watermark-controls h4 {
            color: #0056b3;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .inline-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .inline-controls .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .inline-controls label {
            margin-bottom: 0 !important;
            white-space: nowrap;
            font-weight: 500;
        }

        .inline-controls input[type="file"] {
            width: auto;
            min-width: 220px;
        }

        .inline-controls input[type="range"] {
            width: 150px;
        }

        .inline-controls input[type="number"] {
            width: 80px;
            padding: 6px;
        }

        .inline-controls select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: white;
        }

        .opacity-display {
            font-size: 14px;
            color: #666;
            min-width: 35px;
            text-align: center;
            font-weight: 500;
        }

        .watermark-control-row {
            display: flex;
            gap: 25px;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .export-options {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .export-options label {
            font-weight: 500;
            color: #495057;
            font-size: 14px;
            margin: 0;
        }

        .export-options select {
            padding: 6px 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            background-color: white;
            font-size: 13px;
            min-width: 140px;
        }

        .export-options input[type="number"] {
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
        }

        .refresh-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,123,255,0.2);
        }

        .refresh-btn:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }

        .export-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(40,167,69,0.2);
        }

        .export-btn:hover {
            background-color: #218838;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(40,167,69,0.3);
        }

        .export-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .instructions {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #2196f3;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .instructions ul {
            margin-left: 25px;
        }

        .instructions li {
            margin: 8px 0;
            color: #555;
            line-height: 1.5;
        }

        /* å¯¼å‡ºçŠ¶æ€æç¤º */
        .export-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
        }

        .export-status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .export-status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .export-status.loading {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* æ‰‹åŠ¨è¾“å…¥åŒºåŸŸ */
        .manual-input-section {
            background-color: #fff3cd;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }

        .manual-input-section h4 {
            color: #856404;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .font-size-controls {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }

        .font-size-controls h4 {
            color: #0056b3;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .font-size-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
        }

        .font-size-item label {
            min-width: 90px;
            font-size: 14px;
            color: #555;
            font-weight: 500;
        }

        .font-size-item input[type="number"] {
            width: 80px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .font-size-item span {
            font-size: 12px;
            color: #666;
        }

        .txt-file-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #6c757d;
        }

        .txt-file-section h4 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .auto-fill-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }

        .auto-fill-btn:hover {
            background-color: #545b62;
        }

        /* å›¾ç‰‡åç§°ç¼–è¾‘åŒºåŸŸ */
        .image-name-edit {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #e9ecef;
        }

        .image-name-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 0;
            padding: 8px;
            background-color: white;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }

        .image-name-item label {
            min-width: 60px;
            font-size: 12px;
            color: #666;
            margin: 0;
        }

        .image-name-item input[type="text"] {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
        }

        .image-preview-header {
            font-size: 13px;
            color: #495057;
            font-weight: 500;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .image-name-font-control {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #e3f2fd;
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid #bbdefb;
        }

        .image-name-font-control label {
            margin: 0;
            font-size: 11px;
            color: #1976d2;
            font-weight: 500;
        }

        .image-name-font-control input[type="number"] {
            width: 50px;
            padding: 3px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 11px;
            text-align: center;
        }

        .image-name-font-control span {
            font-size: 11px;
            color: #666;
        }
    
        .image-preview-thumb {
            max-width: 120px;
            max-height: 120px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        .image-name-item button {
            padding: 4px 8px; 
            margin-left: 8px; 
            background: #e74c3c; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer;
            font-size: 11px;
            transition: background-color 0.3s;
        }

        .image-name-item button:hover {
            background: #c0392b;
        }

        /* æ‹–æ‹½æ ·å¼ */
        .dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .drag-handle {
            cursor: grab;
            color: #999;
            font-size: 16px;
            padding: 2px;
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .file-input-group input[type="file"],
            .file-input-group input[type="text"], 
            .file-input-group textarea,
            .file-input-group input[type="number"] {
                padding: 15px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .refresh-btn, .export-btn {
                padding: 16px 24px;
                font-size: 16px;
                min-height: 48px;
                width: 100%;
                margin: 5px 0;
            }
            
            .button-group {
                flex-direction: column;
                width: 100%;
            }
            
            .export-options {
                width: 100%;
                justify-content: center;
                padding: 15px;
            }
            
            .export-options select {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
                flex: 1;
            }
            
            .export-options input[type="number"] {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
                width: 100px;
            }
            
            .auto-fill-btn {
                padding: 12px 20px;
                font-size: 16px;
                min-height: 44px;
                width: 100%;
                margin: 10px 0;
            }
            
            .watermark-control-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .control-group {
                width: 100%;
                justify-content: space-between;
            }
            
            .control-group select,
            .control-group input {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .font-size-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .font-size-item input[type="number"] {
                width: 100%;
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .input-with-font-size {
                flex-direction: column;
                gap: 10px;
            }
            
            .font-size-control {
                width: 100%;
                justify-content: center;
            }
            
            .font-size-control input[type="number"] {
                width: 80px;
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
        }


@media (max-width: 768px) {
    .main-title {
        font-size: 26px;
        line-height: 1.4;
        text-align: center;
        padding: 0 10px;
    }

    .subtitle {
        font-size: 16px;
        line-height: 1.6;
        text-align: center;
        padding: 0 10px;
    }

    .company-intro p {
        font-size: 14px;
        text-indent: 1.5em;
        padding: 0 10px;
    }

    .project-section {
        margin-bottom: 40px;
    }

    .image-container {
        margin: 20px 0;
    }

    .image-caption {
        font-size: 14px;
        padding: 8px 10px;
    }

    .project-image {
        width: 100%;
        max-width: 100%;
        height: auto;
        border-radius: 8px;
    }

    .container {
        padding: 16px;
    }
}
</style>
</head>
<body>
<div class="container">
<!-- ä½¿ç”¨è¯´æ˜ -->
<div class="instructions">
<h3>ä½¿ç”¨è¯´æ˜</h3>
<ul>
<li><strong>æ¨èæ“ä½œé¡ºåºï¼š</strong>æŒ‰ä¸€ã€äºŒã€ä¸‰ã€å››çš„é¡ºåºä¾æ¬¡å®Œæˆè®¾ç½®</li>
<li><strong>æ–‡æ¡ˆè¾“å…¥ï¼š</strong>ä¼˜å…ˆä½¿ç”¨æ‰‹åŠ¨è¾“å…¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©txtæ–‡ä»¶è‡ªåŠ¨å¡«å……ã€‚æ ‡é¢˜å’Œå‰¯æ ‡é¢˜æ”¯æŒæ¢è¡Œæ˜¾ç¤º</li>
<li><strong>å­—ä½“è®¾ç½®ï¼š</strong>æ¯ä¸ªè¾“å…¥æ¡†å³ä¾§éƒ½æœ‰å¯¹åº”çš„å­—ä½“å¤§å°è®¾ç½®</li>
<li><strong>å›¾ç‰‡æ¿å—è®¾ç½®ï¼š</strong>è¾“å…¥éœ€è¦çš„æ¿å—æ•°é‡åï¼Œç‚¹å‡»"æ›´æ–°å›¾ç‰‡é€‰æ‹©æ¡†"ç”Ÿæˆå¯¹åº”æ•°é‡çš„é€‰æ‹©æ¡†</li>
<li><strong>å›¾ç‰‡å¤šé€‰åŠŸèƒ½ï¼š</strong>æ¯ä¸ª"é¡¹ç›®å›¾ç‰‡ X"éƒ½æ”¯æŒå¤šé€‰ï¼Œé€‰</li></ul></div></div></body></html>